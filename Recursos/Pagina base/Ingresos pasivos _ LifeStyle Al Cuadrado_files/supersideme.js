/**
 * SuperSide Me main js engine
 * @package   SuperSideMe
 * @author    Robin Cornett <hello@robincornett.com>
 * @copyright 2015-2017 Robin Cornett
 * @license   GPL-2.0+
 */
!function(e,n,s){"use strict";function a(e){t(e),(I.params.search.button||B())&&r(),0!==R.button.length&&(n(R.button).on("click.supersideme",function(){i()}),n("undefined"!==I.params.second.button)&&n(I.params.second.button).on("click.second-ssme",function(){f(I.params.second)}),n(window).on("resize.supersideme",z).triggerHandler("resize.supersideme"))}function t(e){var s=I.params.navarialabel,a=E.screenReader,t=n(I.params.location).length>0?I.params.location:"body";I.params.navigation&&(s=I.params.navigation,a="label"),B()&&(s=parent.wp.customize.instance("supersideme[navigation]").get());var r=n("<button />",{role:"button","aria-pressed":!1,"aria-expanded":!1,"aria-controls":W.panel,id:e,class:E.menuButton}).append(n("<span />",{class:a,text:s}));n(t).first()[I.params.function](r),n("body").addClass(E.body)}function r(){if(I.params.search.input){var e=I.params.search.button_aria,s=E.screenReader,a="left"===I.params.side?"after":"before";I.params.search.button_text&&(e=I.params.search.button_text,s="label"),B()&&(e=parent.wp.customize.instance("supersideme[search_button_text]").get());var t=n("<button />",{role:"button","aria-pressed":!1,id:E.searchButton,class:E.searchButton}).append(n("<span />",{class:s,text:e}));I.params.location&&"body"!==I.params.location&&n(I.params.location).length||n(R.button).wrap("<div />"),n(R.button).parent().addClass(E.buttonWrap),n(R.button)[a](t);var r=n(R.buttonWrap),i="after",o="last-of-type",u=n(R.searchButton),p="";"0px"===r.css("bottom")&&n.inArray(r.css("position"),["absolute","fixed"])>-1&&(i="before",o="first-of-type",p=-5),n(R.buttonWrap+" > button:"+o)[i](I.params.search.input),n(R.searchInput).css("display","none").css("order",p),I.params.search.button||u.css("display","none"),u.on("click.search",function(){n(R.searchInput).slideToggle(200),C(u,"aria-pressed")})}}function i(){m(),_=!0,n.sidr("open",W.panel)}function o(){return n.sidr("close",W.panel),n(R.sidr+" "+R.submenuToggle).removeClass(E.menuOpen).attr("aria-expanded",!1).next(".sub-menu").slideUp("fast"),!1}function u(e){var s=n("body");return T(e)?void s.removeClass(E.body):void s.addClass(E.body)}function p(){if(0!==W.panel.length&&T(W.panel)){var n=e.getElementById(W.panel);n.style.setProperty("display","block")}}function d(e,s){return T(e)?void n(s).swipe("disable"):(n(s).swipe("enable"),void c(n(s)))}function l(e){var s=I.skipLinks.startLink,a=e,t=n(I.skipLinks.ulClass+' a[href*="#'+I.skipLinks.contains+'"]').not('a[href*="'+I.skipLinks.unique+'"]');T(e)?(s=e,a=I.skipLinks.startLink,n(t).removeAttr("style")):n(t).hide();var r=n(I.skipLinks.ulClass+' a[href*="#'+s+'"]'),i=n(r).attr("href");i&&(i=i.replace(s,a),n(r).attr("href",i))}function c(e){var n=i,s=o;"left"===I.params.side&&(n=o,s=i),e.swipe({allowPageScroll:"vertical",threshold:120,swipeLeft:n,swipeRight:s,preventDefaultEvents:!1})}function m(){var n=null!==I.params.source&&null!==e.getElementById(I.params.source)?"#"+I.params.source:function(){v()},s={button:R.menuButton,source:n,panel:W.panel,side:I.params.side},a="."+W.panel+" "+R.submenuToggle;b(s,a)}function f(e){b(e,"#"+e.panel+" "+R.submenuToggle)}function b(e,s){return g(n(e.button),e),0===n(s).length&&(y(e.panel),k()),n(R.sidr+" "+R.submenuToggle).on("click.supersideme-submenu",w),x(e.panel),!1}function g(e,s){var a=n.sidr("status");a.opened!==s.panel&&n.sidr("close",a.opened),e.sidr({name:s.panel,side:s.side,source:s.source,renaming:!1,displace:I.params.displace,speed:parseInt(I.params.speed,10),method:"toggle",onOpen:function(){e.toggleClass(E.menuOpen),C(e,"aria-pressed"),C(e,"aria-expanded"),h(e)},onClose:function(){e.removeClass(E.menuOpen),C(e,"aria-pressed"),C(e,"aria-expanded"),e.focus(),_=!1}})}function h(e){var s=n(R.sidr+" "+R.inner),a=s.children(),t=a.first(),r=a.last();s.attr({tabindex:"0"}),t.focus(),s.on("keydown.sidrNav",function(n){if(9===n.keyCode)return(r[0]!==n.target||n.shiftKey)&&(t[0]!==n.target&&s[0]!==n.target||!n.shiftKey)?void 0:(e.focus(),!1)}),e.on("keydown.sidrNav",function(n){var s=S();if(s.opened&&9===n.keyCode)return e[0]!==n.target||n.shiftKey?void 0:(t.focus(),!1)})}function v(){var e=I.params.html5?"nav":"div",s=I.params.html5?{class:"side-navigation",role:"navigation",itemscope:"itemscope",itemtype:"http://schema.org/SiteNavigationElement"}:{class:"side-navigation"},a=n("<"+e+" />",s).append(n("<ul />",{class:"side-nav"})),t=n("<div />",{class:E.inner}),r={widget:".supersideme.widget-area",inner:R.panel+" "+R.inner};if(0===n(r.inner).length){if(n(R.panel+R.sidr).prepend(t),I.params.menus&&(n(r.inner).append(a),n(".side-nav").prepend(I.params.menus)),p(),0!==n(r.widget).length){var i=I.params.widget_end?"appendTo":"prependTo";n(r.widget)[i](r.inner).attr("style","display:block;")}I.params.search.panel&&(n(r.inner).prepend(I.params.search.input),"0"===I.params.search_on&&n(".search-me").css("display","none"))}}function y(e){var s=n("<button />",{role:"button","aria-pressed":!1,"aria-label":I.params.subarialabel,class:E.submenuToggle}).append(n("<span />",{class:E.screenReader,text:I.params.submenu}));0===n(e+" "+R.submenuToggle).length&&(n(R.sidr+" .sub-menu").before(s),O(R.sidr+" .menu-item-has-children > a",R.sidr+" "+R.submenuToggle))}function k(){var e=n(R.sidr+' .menu-item-has-children > a[href="#"]');e.addClass(E.submenuToggle).attr("role","button").attr("aria-pressed",!1).next(R.submenuToggle).remove()}function w(){var e=n(this),s=e.closest(".menu-item").siblings();C(e,"aria-pressed"),e.toggleClass(E.menuOpen),e.next(".sub-menu").slideToggle("fast"),s.find(R.submenuToggle).removeClass(E.menuOpen).attr("aria-pressed",!1),s.find(".sub-menu").slideUp("fast")}function x(e){var s=e.indexOf("#")<=0?"#"+e:e;0===n(s+" .menu-close").length&&n(s+" "+R.sidr+"-inner").prepend(I.params.close),n(s+" "+I.params.closeevent).on("click",function(){n(this).attr("aria-pressed",!1),n.sidr("close",e),n(R.sidr+" "+R.submenuToggle).removeClass(E.menuOpen).attr("aria-expanded",!1).next(".sub-menu").slideUp("fast")})}function T(n){var s=e.getElementById(n),a=window.getComputedStyle(s);return"none"===a.getPropertyValue("display")}function C(e,n){e.attr(n,function(e,n){return"false"===n})}function B(){return Boolean(I.params.search_on)}function L(e,n,s){var a;return function(){var t=this,r=arguments,i=function(){a=null,s||e.apply(t,r)},o=s&&!a;clearTimeout(a),a=setTimeout(i,n),o&&e.apply(t,r)}}function O(e,s){n(s).css("height",n(e).outerHeight())}function S(){return jQuery.sidr("status")}var I={},_=!1,W={button:"slide-menu",panel:"side-menu"},E={sidr:"sidr",menuButton:"slide-nav-link",submenuToggle:"sub-menu-toggle",menuOpen:"menu-open",searchButton:"ssme-search",buttonWrap:"ssme-buttons",screenReader:"screen-reader-text",body:"supersideme",inner:"sidr-inner"},R={sidr:"."+E.sidr,panel:"#"+W.panel,menuButton:"."+E.menuButton,submenuToggle:"."+E.submenuToggle,button:"#"+W.button,searchButton:"."+E.searchButton,buttonWrap:"."+E.buttonWrap,searchInput:"."+E.buttonWrap+" .search-me",inner:"."+E.inner};I.init=function(){a(W.button)};var z=L(function(){var e=W.button;u(e),I.params.swipe&&d(e,"body"),I.skipLinks="undefined"==typeof supersidemeSkipLinks?"":supersidemeSkipLinks,"undefined"!=typeof I.skipLinks&&l(e),T(e)&&(n(R.searchInput).hide(),o())},250);n(e).ready(function(){I.params="undefined"==typeof SuperSideMeVar?"":SuperSideMeVar,"undefined"!=typeof I.params&&I.init()})}(document,jQuery);